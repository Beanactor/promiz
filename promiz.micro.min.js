!function(){function a(b,c){function d(){var a;try{a=g&&g.then}catch(h){return g=h,f=2,d()}j(a,function(){f=1,d()},function(){f=2,d()},function(){try{1==f&&"function"==typeof b&&(g=b(g)),2==f&&"function"==typeof c&&(g=c(g),f=1)}catch(d){return g=d,i()}g==e?(g=TypeError(),i()):j(a,function(){i(3)},i,function(){i(1==f&&3)})})}var e=this;e.promise=e;var f=0,g=0,b=b||0,c=c||0,h=[];e.resolve=function(a){f||(g=a,f=1,setImmediate(d))},e.reject=function(a){f||(g=a,f=2,setImmediate(d))},e.then=function(b,c){var d=new a(b,c);return h.push(d),3==f&&d.resolve(g),4==f&&d.reject(g),d};var i=function(a){f=a||4,3==f&&h.map(function(a){a.resolve(g)}),4==f&&h.map(function(a){a.reject(g)})},j=function(a,b,c,d){if("object"==typeof g&&"function"==typeof a)try{var e=0;a.call(g,function(a){e++||(g=a,b())},function(a){e++||(g=a,c())})}catch(f){g=f,c()}else d()}}var b={defer:function(){return new a}};"undefined"!=typeof module?module.exports=b:this.Promiz=b}();